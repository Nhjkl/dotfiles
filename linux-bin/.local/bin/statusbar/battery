#!/bin/sh

# Prints all batteries, their percentage remaining and an emoji corresponding
# to charge status (ğŸ”Œ for plugged up, ï– for discharging on battery, etc.).

case $BLOCK_BUTTON in
	3) notify-send "ï– Battery module" "ï–: discharging
ï­¦: not charging
ï•¸: stagnant charge
ï–„: charging
ï–ƒ: charged
ï–‚: battery very low!
- Scroll to change adjust xbacklight." ;;
	4) xbacklight -inc 10 ;;
	5) xbacklight -dec 10 ;;
	6) "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

# Loop through all attached batteries.
for battery in /sys/class/power_supply/BAT?
do
	# Get its remaining capacity and charge status.
	capacity=$(cat "$battery"/capacity 2>/dev/null) || break

	status=$(sed "s/[Dd]ischarging/ï–/;s/[Nn]ot charging/ï­¦/;s/[Cc]harging/ï–„/;s/[Uu]nknown/ï–ƒ/;s/[Ff]ull/ï–ƒ/" "$battery"/status)

  [ "$capacity" -le 25 ] && [ "$status" = "ï–" ] && warn="ï–‚"

	printf "%s%s%s%% " "$status" "$warn" "$capacity"
	unset warn
done | sed 's/ *$//'
